# â›©ï¸ NostrShrine

Nosträ¸Šã§å‹•ä½œã™ã‚‹ã€å®Œå…¨ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã®ç¥ç¤¾ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã€‚å‚æ‹è¨˜éŒ²ã‚„ãŠã¿ãã˜ã‚’Nostrã®ã‚¤ãƒ™ãƒ³ãƒˆã¨ã—ã¦ç®¡ç†ã—ã¾ã™ã€‚

## ğŸŒŸ ç‰¹å¾´

- **ğŸ™ å‚æ‹æ©Ÿèƒ½**: å‚æ‹è¨˜éŒ²ã‚’Nostr (kind 3081) ã«ä¿å­˜
- **ğŸ´ ãŠã¿ãã˜**: é‹å‹¢ã‚’ãƒ©ãƒ³ãƒ€ãƒ ã«å¼•ã„ã¦ã€çµæœã‚’Nostrã«æŠ•ç¨¿å¯èƒ½
- **ğŸ” NIP-07èªè¨¼**: ãƒ–ãƒ©ã‚¦ã‚¶æ‹¡å¼µæ©Ÿèƒ½ï¼ˆAlby, nos2xç­‰ï¼‰ã«ã‚ˆã‚‹å®‰å…¨ãªèªè¨¼
- **âš¡ å®Œå…¨ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰**: ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ä¸è¦ã€ã™ã¹ã¦Nostrãƒªãƒ¬ãƒ¼çµŒç”±
- **ğŸ¦€ rust-nostr WASM**: é«˜æ€§èƒ½ãªrust-nostrã‚’WebAssemblyã§åˆ©ç”¨
- **ğŸ¨ ç¥ç¤¾ãƒ†ãƒ¼ãƒ**: æœ±è‰²ã¨é‡‘è‰²ã‚’ãƒ™ãƒ¼ã‚¹ã¨ã—ãŸå’Œã®ãƒ‡ã‚¶ã‚¤ãƒ³
- **ğŸ¤– LLMç”Ÿæˆ**: ç®¡ç†è€…ã¯OpenAI APIã‚’ä½¿ã£ã¦ãŠã¿ãã˜ã‚’è‡ªå‹•ç”Ÿæˆ

## ğŸ“¦ æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

- **ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰**: React + TypeScript + Vite
- **UI**: Material-UI (MUI)
- **Nostr**: rust-nostr (WASMãƒã‚¤ãƒ³ãƒ‡ã‚£ãƒ³ã‚°è‡ªä½œ)
- **LLM**: OpenAI API (gpt-4o-mini)
- **ãƒ‡ãƒ—ãƒ­ã‚¤**: GitHub Pages

## ğŸš€ ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

### å¿…è¦ãªç’°å¢ƒ

- Node.js 20+
- pnpm 9+
- Rust (stable)
- wasm-pack

### ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```bash
# ãƒªãƒã‚¸ãƒˆãƒªã‚’ã‚¯ãƒ­ãƒ¼ãƒ³
git clone https://github.com/yourusername/NostrShrine.git
cd NostrShrine

# ä¾å­˜é–¢ä¿‚ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
pnpm install

# WASMã‚’ãƒ“ãƒ«ãƒ‰
cd rust-nostr-wasm
wasm-pack build --target web --out-dir ../src/wasm
cd ..

# ç’°å¢ƒå¤‰æ•°ã‚’è¨­å®š
cp .env.example .env
# .envã‚’ç·¨é›†ã—ã¦ç®¡ç†è€…ã®å…¬é–‹éµã‚’è¨­å®š
```

### é–‹ç™ºã‚µãƒ¼ãƒãƒ¼èµ·å‹•

```bash
pnpm run dev
```

http://localhost:5173 ã§ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒèµ·å‹•ã—ã¾ã™ã€‚

### ãƒ“ãƒ«ãƒ‰

```bash
pnpm run build
```

## ğŸ”§ ç’°å¢ƒå¤‰æ•°

`.env` ãƒ•ã‚¡ã‚¤ãƒ«ã§ä»¥ä¸‹ã®å¤‰æ•°ã‚’è¨­å®šã§ãã¾ã™ï¼š

```env
# ç®¡ç†è€…ã®å…¬é–‹éµï¼ˆã‚«ãƒ³ãƒåŒºåˆ‡ã‚Šã§è¤‡æ•°æŒ‡å®šå¯èƒ½ï¼‰
VITE_ADMIN_PUBKEYS=npub1xxx,npub1yyy

# ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒªãƒ¬ãƒ¼ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰
VITE_DEFAULT_RELAY=wss://r.kojira.io
```

## ğŸ“± ä½¿ã„æ–¹

### ä¸€èˆ¬ãƒ¦ãƒ¼ã‚¶ãƒ¼

1. NIP-07å¯¾å¿œã®ãƒ–ãƒ©ã‚¦ã‚¶æ‹¡å¼µæ©Ÿèƒ½ï¼ˆAlby, nos2xç­‰ï¼‰ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
2. ã€Œãƒ­ã‚°ã‚¤ãƒ³ã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦èªè¨¼
3. **å‚æ‹ã™ã‚‹**: å‚æ‹è¨˜éŒ²ã‚’Nostrã«æŠ•ç¨¿
4. **ãŠã¿ãã˜ã‚’å¼•ã**: ãƒ©ãƒ³ãƒ€ãƒ ã§ãŠã¿ãã˜ã‚’å¼•ã„ã¦ã€çµæœã‚’Nostrã«æŠ•ç¨¿å¯èƒ½

### ç®¡ç†è€…

ç®¡ç†è€…ã¨ã—ã¦èªè¨¼ã™ã‚‹ã¨ã€è¿½åŠ ã®æ©Ÿèƒ½ãŒåˆ©ç”¨ã§ãã¾ã™ï¼š

1. **ãŠã¿ãã˜ç”Ÿæˆ**: OpenAI APIã‚­ãƒ¼ã‚’è¨­å®šã—ã€LLMã§ãŠã¿ãã˜ã‚’ç”Ÿæˆ
2. **ä¸€æ‹¬ç”Ÿæˆ**: è¤‡æ•°ã®ãŠã¿ãã˜ã‚’ä¸€åº¦ã«ç”Ÿæˆã—ã¦Nostrã«ä¿å­˜
3. **ãƒªãƒ¬ãƒ¼ç®¡ç†**: æ¥ç¶šã™ã‚‹ãƒªãƒ¬ãƒ¼ã®è¿½åŠ ãƒ»å‰Šé™¤

## ğŸ“‹ Nostrã‚¤ãƒ™ãƒ³ãƒˆä»•æ§˜

### kind 3081: å‚æ‹è¨˜éŒ²

```json
{
  "kind": 3081,
  "content": "{\"shrine_name\":\"NostrShrine\",\"message\":\"å‚æ‹ã—ã¾ã—ãŸ\",\"visited_at\":1234567890}",
  "tags": [
    ["shrine", "NostrShrine"]
  ]
}
```

### kind 1: ãŠã¿ãã˜çµæœæŠ•ç¨¿

```json
{
  "kind": 1,
  "content": "ğŸ´ ãŠã¿ãã˜ã®çµæœ\n\né‹å‹¢: å¤§å‰\n\n...",
  "tags": [
    ["t", "NostrShrine"],
    ["t", "ãŠã¿ãã˜"],
    ["fortune", "å¤§å‰"]
  ]
}
```

### kind 30394: ãŠã¿ãã˜ãƒ‡ãƒ¼ã‚¿ï¼ˆç®¡ç†è€…ãŒäº‹å‰ç”Ÿæˆï¼‰

```json
{
  "kind": 30394,
  "content": "{\"fortune\":\"å¤§å‰\",\"general\":\"...\",\"love\":\"...\",\"money\":\"...\"}",
  "tags": [
    ["d", "omikuji-{unique-id}"],
    ["fortune", "å¤§å‰"]
  ]
}
```

### kind 10381: ç®¡ç†è€…ãƒªã‚¹ãƒˆ

```json
{
  "kind": 10381,
  "content": "{\"admins\":[\"pubkey1\",\"pubkey2\"],\"updated_at\":1234567890}",
  "tags": [
    ["d", "nostrshrine-admins"],
    ["p", "pubkey1"],
    ["p", "pubkey2"]
  ]
}
```

### kind 10394: ã‚¢ãƒ—ãƒªè¨­å®š

```json
{
  "kind": 10394,
  "content": "{\"daily_omikuji_limit\":3,\"relays\":[\"wss://r.kojira.io\"]}",
  "tags": [
    ["d", "nostrshrine-settings"]
  ]
}
```

## ğŸ—ï¸ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹é€ 

```
NostrShrine/
â”œâ”€â”€ rust-nostr-wasm/        # Rust WASM ãƒã‚¤ãƒ³ãƒ‡ã‚£ãƒ³ã‚°
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â””â”€â”€ lib.rs          # rust-nostr ã®ãƒ©ãƒƒãƒ‘ãƒ¼
â”‚   â””â”€â”€ Cargo.toml
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ components/         # Reactã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”‚   â”‚   â”œâ”€â”€ admin/          # ç®¡ç†è€…ç”¨ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”‚   â”‚   â”œâ”€â”€ ShrineVisit.tsx # å‚æ‹ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”‚   â”‚   â””â”€â”€ Omikuji.tsx     # ãŠã¿ãã˜ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”‚   â”œâ”€â”€ contexts/           # React Context
â”‚   â”‚   â”œâ”€â”€ AuthContext.tsx # èªè¨¼ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ RelayContext.tsx # ãƒªãƒ¬ãƒ¼æ¥ç¶šç®¡ç†
â”‚   â”‚   â””â”€â”€ AdminContext.tsx # ç®¡ç†è€…æ¨©é™ç®¡ç†
â”‚   â”œâ”€â”€ hooks/              # ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯
â”‚   â”œâ”€â”€ lib/
â”‚   â”‚   â””â”€â”€ nostr/          # Nostrã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ
â”‚   â”‚       â”œâ”€â”€ client.ts   # WASMãƒ©ãƒƒãƒ‘ãƒ¼
â”‚   â”‚       â”œâ”€â”€ nip07.ts    # NIP-07å®Ÿè£…
â”‚   â”‚       â”œâ”€â”€ relay.ts    # ãƒªãƒ¬ãƒ¼æ¥ç¶š
â”‚   â”‚       â””â”€â”€ events.ts   # ã‚¤ãƒ™ãƒ³ãƒˆä½œæˆ
â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â””â”€â”€ llm/            # LLMçµ±åˆ
â”‚   â”‚       â”œâ”€â”€ types.ts
â”‚   â”‚       â”œâ”€â”€ openai.ts   # OpenAIãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼
â”‚   â”‚       â””â”€â”€ index.ts
â”‚   â”œâ”€â”€ config/
â”‚   â”‚   â””â”€â”€ constants.ts    # å®šæ•°å®šç¾©
â”‚   â””â”€â”€ wasm/               # ãƒ“ãƒ«ãƒ‰ã•ã‚ŒãŸWASMï¼ˆè‡ªå‹•ç”Ÿæˆï¼‰
â”œâ”€â”€ .github/
â”‚   â””â”€â”€ workflows/
â”‚       â””â”€â”€ deploy.yml      # GitHub Pages ãƒ‡ãƒ—ãƒ­ã‚¤
â””â”€â”€ vite.config.ts
```

## ğŸ¤ ã‚³ãƒ³ãƒˆãƒªãƒ“ãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³

ãƒ—ãƒ«ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’æ­“è¿ã—ã¾ã™ï¼

1. ã“ã®ãƒªãƒã‚¸ãƒˆãƒªã‚’ãƒ•ã‚©ãƒ¼ã‚¯
2. æ©Ÿèƒ½ãƒ–ãƒ©ãƒ³ãƒã‚’ä½œæˆ (`git checkout -b feature/amazing-feature`)
3. å¤‰æ›´ã‚’ã‚³ãƒŸãƒƒãƒˆ (`git commit -m 'Add some amazing feature'`)
4. ãƒ–ãƒ©ãƒ³ãƒã«ãƒ—ãƒƒã‚·ãƒ¥ (`git push origin feature/amazing-feature`)
5. ãƒ—ãƒ«ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’ä½œæˆ

## ğŸ“„ ãƒ©ã‚¤ã‚»ãƒ³ã‚¹

MIT License

## ğŸ™ è¬è¾

- [rust-nostr](https://github.com/rust-nostr/nostr) - é«˜æ€§èƒ½ãªNostrãƒ©ã‚¤ãƒ–ãƒ©ãƒª
- [Material-UI](https://mui.com/) - ç¾ã—ã„UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
- [Nostr Protocol](https://github.com/nostr-protocol/nostr) - åˆ†æ•£å‹ãƒ—ãƒ­ãƒˆã‚³ãƒ«

---

Made with â¤ï¸ and â›©ï¸
